#include "TXLib.h"

struct Forma
{
    string text_question;
    int right_answer;
    HDC pic_answer1;
    string text_answer1;
    HDC pic_answer2;
    string text_answer2;
    HDC pic_answer3;
    string text_answer3;
};

void drawAnswer(int x, HDC pic_answer, string text_answer)
{
    txSelectFont("Times New Roman", 40);
    txSetColor (TX_WHITE, 7);
    txRectangle (x, 320, x+200, 470);
    txBitBlt(txDC(), x, 320, 200, 150, pic_answer);
    txDrawText  (x, 500, x+200, 550, text_answer.c_str());
}

bool clickAnswer(int x)
{
    return(txMouseButtons()==1 && txMouseX()>x && txMouseX()<x+200 && txMouseY()>320 && txMouseY()<470);
}

int main()
{
txCreateWindow (800, 600);

    int kol_question = 3;

    Forma quest_buf;

    Forma quest[kol_question];

    quest[0] = {"В каком городе больше жителей?", 2,
                    txLoadImage("Картинки/Ульяновск.bmp"), "Ульяновск",
                    txLoadImage("Картинки/Москва.bmp"), "Москва",
                    txLoadImage("Картинки/Самара.bmp"), "Самара"};

    quest[1] = {"Оружейная столица России?", 3,
                    txLoadImage("Картинки/Псков.bmp"), "Псков",
                    txLoadImage("Картинки/Тверь.bmp"), "Тверь",
                    txLoadImage("Картинки/Тула.bmp"), "Тула"};

    quest[2] = {"Самый северный город России?", 3,
                    txLoadImage("Картинки/Москва.bmp"), "Москва",
                    txLoadImage("Картинки/Тверь.bmp"), "Тверь",
                    txLoadImage("Картинки/Мурманск.bmp"), "Мурманск"};

    int n_question = 1;
    int kol_right_answer = 0;


    while(n_question <= kol_question)
    {
        txSetColor (TX_BLACK);
        txSetFillColor (TX_BLACK);
        txClear();
        txBegin();

        quest_buf = quest[n_question - 1];

        //ШАБЛОН
        txSetColor (TX_WHITE, 1);
        txSetFillColor (TX_TRANSPARENT);
        txRectangle (10, 10, 790, 590);
        //Номер и количество вопросов
        char str[50];
        sprintf(str, "Вопрос %d/%d", n_question, kol_question);
        txDrawText(0, 20, 800, 50, str);
        //Вопрос
        txSelectFont("Times New Roman", 60);
        txDrawText(0, 0, 800, 200, quest_buf.text_question.c_str());
        //Ответы
        drawAnswer( 50, quest_buf.pic_answer1, quest_buf.text_answer1);
        drawAnswer(300, quest_buf.pic_answer2, quest_buf.text_answer2);
        drawAnswer(550, quest_buf.pic_answer3, quest_buf.text_answer3);

        if(clickAnswer(50))
        {
            if(quest_buf.right_answer == 1)
            {
                kol_right_answer ++;
            }
            txSleep(200);
            n_question++;
        }

        if(clickAnswer(300))
        {
            txSleep(200);
            n_question++;
        }

        if(clickAnswer(550))
        {
            txSleep(200);
            n_question++;
        }
        txEnd();
        txSleep(20);
    }

    txSetColor (TX_WHITE);
    txSetFillColor (TX_BLACK);
    txClear();
    txDrawText(0, 0, 800, 600, "РЕЗУЛЬТАТ");

    txDeleteDC (quest_buf.pic_answer1);
    txDeleteDC (quest_buf.pic_answer2);
    txDeleteDC (quest_buf.pic_answer3);

txTextCursor (false);
return 0;
}
